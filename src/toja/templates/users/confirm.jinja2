{% extends "../centred_narrow_layout.jinja2" %}
{% import "../macros/form.jinja2" as form with context %}

{% block title %}The Old Joke Archive - Set your Password{% endblock title %}
{% block content %}
  {% if user is defined %}
  <form action="{{ 'users.confirm'|route_url(email=user.email, token=user.attributes['validation_token']) }}" method="post" novalidate>
    <h1>Set your Password</h1>
    <div>{{ form.field('password', 'password', 'Password', attributes={'required': 'required'}) }}</div>
    <div>{{ form.field('confirm_password', 'password', 'Confirm your Password', attributes={'required': 'required'}) }}</div>
    <div class="text-right">
      <button class="button">Set my Password</button>
    </div>
  </form>
  {% else %}
    <h1>Password change failed</h1>
    <p>Either no user exists with this e-mail address, the user is already confirmed, or the token is incorrect.</p>
  {% endif %}
{% endblock content %}
