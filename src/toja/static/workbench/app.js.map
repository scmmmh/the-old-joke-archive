{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?45d8","webpack:///./src/components/JokeSelector.vue?1eb9","webpack:///./src/components/JokeSelector.vue?7bbc","webpack:///./src/components/JokeSelector.vue?006b","webpack:///./src/components/JokeSelector.vue","webpack:///./src/components/JokeList.vue?8bc7","webpack:///./src/components/JokeList.vue?5e5d","webpack:///./src/components/JokeList.vue?b975","webpack:///./src/components/JokeList.vue","webpack:///./src/components/JokeTranscriber.vue?8212","webpack:///./src/markup/AnnotationMark.ts","webpack:///./src/components/JokeTranscriber.vue?741b","webpack:///./src/components/JokeTranscriber.vue?d545","webpack:///./src/components/JokeTranscriber.vue","webpack:///./src/App.vue?ec60","webpack:///./src/App.vue?640d","webpack:///./src/App.vue","webpack:///./src/store.ts","webpack:///./src/main.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","staticRenderFns","modeMove","on","$event","setMode","modeAdd","modeEdit","modeNotMove","zoomInitial","zoomIn","zoomOut","modeNotEdit","nothingSelected","saveChanges","discardChanges","staticStyle","guid","viewer","canvas","viewerWidth","viewerHeight","zoom","imgBounds","x","y","width","height","dragging","img","newRect","jokes","selected","$data","document","querySelector","fabric","Canvas","set","selection","uniScaleTransform","opt","mouseDown","e","mouseMove","mouseUp","mouseScroll","objectSelected","objectDeselected","addEventListener","resize","removeEventListener","clientWidth","clientHeight","setWidth","setHeight","maxZoom","transform","viewportTransform","setViewportTransform","update","forEach","joke","selectable","discardActiveObject","renderAll","hoverCursor","Math","min","max","ev","startMouseX","offsetX","startMouseY","offsetY","Rect","left","top","fill","stroke","hasRotatingPoint","hasBorders","hasCorners","add","$store","dispatch","getBoundingRect","remove","deltaX","deltaY","getActiveObject","sourceData","attributes","bbox","jid","id","newValue","oldValue","rect","transparentCorners","cornerColor","Image","fromURL","sendToBack","setZoom","component","deleteSelected","_l","selectedJoke","select","raw","_v","commit","state","editor","scopedSlots","_u","fn","ref","commands","isActive","annotation","_e","setAnnotationAttributeValue","target","domProps","hasAnnotationAttributeValue","_s","label","attr","type","getAnnotationAttributeValue","entry","hasAttributeValue","checked","addAttributeValue","removeAttributeValue","setAttributeValue","getAttributeValue","keyUp","autosuggests","suggest","category","default","settings","parseDOM","tag","toDOM","class","extensions","destroy","text","getJSON","setContent","transcription","values","indexOf","event","undefined","keyCode","a","autosuggest","params","then","response","attrName","selectedNodes","node","marks","mark","from","to","doc","nodesBetween","schema","dispatchTransaction","multiple","annotations","metadata","components","EditorContent","EditorMenuBar","JokeSelector","JokeList","JokeTranscriber","makeInitialState","config","baseURL","sourceId","userId","source","makeStore","Store","mutations","updateSource","updateJokesList","selectJoke","setTranscription","actions","loadSource","store","loadJokes","loadTranscription","selectedId","response2","source_id","status","addJoke","post","parent_id","updateJoke","put","newJokes","joke2","deleteJoke","delete","updateTranscription","patch","use","productionTip","configElement","getElementById","JSON","parse","innerHTML","render","h","$mount"],"mappings":"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","file":"js/app.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([1,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"workbench\",attrs:{\"id\":\"app\"}},[_c('joke-selector'),_c('joke-list'),_c('joke-transcriber')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('nav',[_c('ul',{staticClass:\"menu\",attrs:{\"role\":\"menu\"}},[_c('li',{attrs:{\"role\":\"presentation\"}},[_c('a',{attrs:{\"role\":\"menuitem\",\"aria-current\":_vm.modeMove},on:{\"click\":function($event){return _vm.setMode('move')}}},[_c('svg',{staticClass:\"icon mdi\",attrs:{\"viewBox\":\"0 0 24 24\"}},[_c('path',{attrs:{\"d\":\"M13,6V11H18V7.75L22.25,12L18,16.25V13H13V18H16.25L12,22.25L7.75,18H11V13H6V16.25L1.75,12L6,7.75V11H11V6H7.75L12,1.75L16.25,6H13Z\"}})])])]),_c('li',{attrs:{\"role\":\"presentation\"}},[_c('a',{attrs:{\"role\":\"menuitem\",\"aria-current\":_vm.modeAdd},on:{\"click\":function($event){return _vm.setMode('add')}}},[_c('svg',{staticClass:\"icon mdi\",attrs:{\"viewBox\":\"0 0 24 24\"}},[_c('path',{attrs:{\"d\":\"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z\"}})])])]),_c('li',{attrs:{\"role\":\"presentation\"}},[_c('a',{attrs:{\"role\":\"menuitem\",\"aria-current\":_vm.modeEdit},on:{\"click\":function($event){return _vm.setMode('edit')}}},[_c('svg',{staticClass:\"icon mdi\",attrs:{\"viewBox\":\"0 0 24 24\"}},[_c('path',{attrs:{\"d\":\"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z\"}})])])]),_c('li',{attrs:{\"role\":\"separator\"}}),_c('li',{attrs:{\"role\":\"presentation\"}},[_c('a',{attrs:{\"role\":\"menuitem\",\"aria-hidden\":_vm.modeNotMove},on:{\"click\":_vm.zoomInitial}},[_c('svg',{staticClass:\"icon mdi\",attrs:{\"viewBox\":\"0 0 24 24\"}},[_c('path',{attrs:{\"d\":\"M9.5,13.09L10.91,14.5L6.41,19H10V21H3V14H5V17.59L9.5,13.09M10.91,9.5L9.5,10.91L5,6.41V10H3V3H10V5H6.41L10.91,9.5M14.5,13.09L19,17.59V14H21V21H14V19H17.59L13.09,14.5L14.5,13.09M13.09,9.5L17.59,5H14V3H21V10H19V6.41L14.5,10.91L13.09,9.5Z\"}})])])]),_c('li',{attrs:{\"role\":\"presentation\"}},[_c('a',{attrs:{\"role\":\"menuitem\",\"aria-hidden\":_vm.modeNotMove},on:{\"click\":_vm.zoomIn}},[_c('svg',{staticClass:\"icon mdi\",attrs:{\"viewBox\":\"0 0 24 24\"}},[_c('path',{attrs:{\"d\":\"M15.5,14L20.5,19L19,20.5L14,15.5V14.71L13.73,14.43C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.43,13.73L14.71,14H15.5M9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14M12,10H10V12H9V10H7V9H9V7H10V9H12V10Z\"}})])])]),_c('li',{attrs:{\"role\":\"presentation\"}},[_c('a',{attrs:{\"role\":\"menuitem\",\"aria-hidden\":_vm.modeNotMove},on:{\"click\":_vm.zoomOut}},[_c('svg',{staticClass:\"icon mdi\",attrs:{\"viewBox\":\"0 0 24 24\"}},[_c('path',{attrs:{\"d\":\"M15.5,14H14.71L14.43,13.73C15.41,12.59 16,11.11 16,9.5A6.5,6.5 0 0,0 9.5,3A6.5,6.5 0 0,0 3,9.5A6.5,6.5 0 0,0 9.5,16C11.11,16 12.59,15.41 13.73,14.43L14,14.71V15.5L19,20.5L20.5,19L15.5,14M9.5,14C7,14 5,12 5,9.5C5,7 7,5 9.5,5C12,5 14,7 14,9.5C14,12 12,14 9.5,14M7,9H12V10H7V9Z\"}})])])]),_c('li',{attrs:{\"role\":\"presentation\"}},[_c('a',{attrs:{\"role\":\"menuitem\",\"aria-hidden\":_vm.modeNotEdit,\"disabled\":_vm.nothingSelected},on:{\"click\":_vm.saveChanges}},[_c('svg',{staticClass:\"icon mdi\",attrs:{\"viewBox\":\"0 0 24 24\"}},[_c('path',{attrs:{\"d\":\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"}})])])]),_c('li',{attrs:{\"role\":\"presentation\"}},[_c('a',{attrs:{\"role\":\"menuitem\",\"aria-hidden\":_vm.modeNotEdit,\"disabled\":_vm.nothingSelected},on:{\"click\":_vm.discardChanges}},[_c('svg',{staticClass:\"icon mdi\",attrs:{\"viewBox\":\"0 0 24 24\"}},[_c('path',{attrs:{\"d\":\"M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12C4,13.85 4.63,15.55 5.68,16.91L16.91,5.68C15.55,4.63 13.85,4 12,4M12,20A8,8 0 0,0 20,12C20,10.15 19.37,8.45 18.32,7.09L7.09,18.32C8.45,19.37 10.15,20 12,20Z\"}})])])])])]),_c('div',{staticStyle:{\"overflow\":\"hidden\"},attrs:{\"id\":_vm.guid}},[_c('canvas')])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Watch } from 'vue-property-decorator';\n// @ts-ignore\nimport { fabric } from 'fabric-browseronly';\nimport { Joke } from '@/interfaces';\n\n@Component\nexport default class JokeSelector extends Vue {\n    private guid = 'joke-selector-canvas';\n    private viewer = null;\n    private canvas = null;\n\n    // Init the canvas state\n    private viewerWidth = 0;\n    private viewerHeight = 0;\n    private zoom = 1;\n    private imgBounds = {x: 0, y: 0, width: 0, height: 0};\n    private dragging = false;\n    private img: fabric.Image = null;\n    private mode = 'move';\n    private newRect: fabric.Rect = null;\n    private jokes: fabric.Rect[] = [];\n    private selected: fabric.Rect = null;\n\n    // ****************\n    // Lifecycle events\n    // ****************\n\n    /**\n     * Upon mounting, setup the Fabric Canvas and attach all the listeners.\n     */\n    public mounted() {\n        this.$data.viewer = document.querySelector('#' + this.$data.guid);\n        if (this.$data.viewer) {\n            this.$data.canvas = new fabric.Canvas(this.$data.viewer.querySelector('canvas'));\n            this.$data.canvas.set({\n                selection: false,\n                uniScaleTransform: true,\n            });\n            this.$data.canvas.on('mouse:down', (opt: fabric.Event) => { this.mouseDown(opt.e); });\n            this.$data.canvas.on('mouse:move', (opt: fabric.Event) => { this.mouseMove(opt.e); });\n            this.$data.canvas.on('mouse:up', (opt: fabric.Event) => { this.mouseUp(opt.e); });\n            this.$data.canvas.on('mouse:dblclick', () => { this.zoomIn(); });\n            this.$data.canvas.on('mouse:wheel', (opt: fabric.Event) => { this.mouseScroll(opt.e); });\n            this.$data.canvas.on('selection:created', (opt: fabric.Event) => { this.objectSelected(); });\n            this.$data.canvas.on('selection:cleared', (opt: fabric.Event) => { this.objectDeselected(); });\n            window.addEventListener('resize', this.resize);\n            this.resize();\n        }\n    }\n\n    /**\n     * Before destroying remove the resize listener.\n     */\n    public beforeDestroy() {\n        window.removeEventListener('resize', this.resize);\n    }\n\n    // **************\n    // Event handlers\n    // **************\n\n    /**\n     * Handle resizing the window\n     */\n    public resize() {\n        this.$data.viewerWidth = this.$data.viewer.clientWidth;\n        this.$data.viewerHeight = this.$data.viewer.clientHeight;\n        this.$data.canvas.setWidth(this.$data.viewerWidth);\n        this.$data.canvas.setHeight(this.$data.viewerHeight);\n        if (this.$data.img) {\n            this.$data.zoom = this.$data.viewerHeight / this.$data.imgBounds.height;\n            this.$data.maxZoom = this.$data.zoom;\n            const transform = this.$data.canvas.viewportTransform;\n            transform[5] = 0;\n            this.$data.canvas.setViewportTransform(transform);\n            this.update();\n        }\n    }\n\n    /**\n     * Switch the joke selection view between \"move\", \"add\", and \"edit\".\n     */\n    public setMode(mode: string) {\n        if (this.$data.mode === 'edit') {\n            this.$data.jokes.forEach((joke: fabric.Rect) => {\n                joke.set({selectable: false});\n            });\n            this.$data.canvas.discardActiveObject().renderAll();\n            this.$data.canvas.hoverCursor = 'pointer';\n        }\n        this.$data.mode = mode;\n        if (mode === 'move') {\n            this.$data.canvas.hoverCursor = 'move';\n        } else if (mode === 'add') {\n            this.$data.canvas.hoverCursor = 'crosshair';\n        } else if (mode === 'edit') {\n            this.$data.canvas.hoverCursor = 'pointer';\n            this.$data.jokes.forEach((joke: fabric.Rect) => {\n                joke.set({selectable: true});\n            });\n            this.$data.canvas.renderAll();\n        }\n    }\n\n    /**\n     * Zoom to the inital full image zoom.\n     */\n    public zoomInitial() {\n        this.$data.zoom = this.$data.maxZoom;\n        const transform = this.$data.canvas.viewportTransform;\n        transform[5] = 0;\n        this.$data.canvas.setViewportTransform(transform);\n        this.update();\n    }\n\n    /**\n     * Zoom in one step. Zoom is split into 5 steps.\n     */\n    public zoomIn() {\n        this.$data.zoom = Math.min(this.$data.zoom + (1 - this.$data.maxZoom) / 5, 1);\n        this.update();\n    }\n\n    /**\n     * Zoom out one step. Zoom is split into 5 steps.\n     */\n    public zoomOut() {\n        this.$data.zoom = Math.max(this.$data.zoom - (1 - this.$data.maxZoom) / 5, this.$data.maxZoom);\n        this.update();\n    }\n\n    /**\n     * Handle the mouse down event. If the mode is \"add\", then create a new rectangle to show where the new\n     * extract is added.\n     */\n    public mouseDown(ev: MouseEvent) {\n        this.$data.dragging = true;\n        this.$data.startMouseX = ev.offsetX;\n        this.$data.startMouseY = ev.offsetY;\n        if (this.$data.mode === 'add') {\n            this.$data.newRect = new fabric.Rect({\n                left: (ev.offsetX - this.$data.canvas.viewportTransform[4]) / this.$data.zoom,\n                top: (ev.offsetY - this.$data.canvas.viewportTransform[5]) / this.$data.zoom,\n                width: 0,\n                height: 0,\n                fill: 'transparent',\n                stroke: '#00aa00',\n                hasRotatingPoint: false,\n                hasBorders: false,\n                hasCorners: false,\n            });\n            this.$data.canvas.add(this.$data.newRect);\n        }\n    }\n\n    /**\n     * Handle the mouse moving event on the canvas. If the mode is \"move\", then it pans the viewport. If the mode is\n     * \"add\" it modifies the size of the new rectangle.\n     */\n    public mouseMove(ev: MouseEvent) {\n        if (this.$data.dragging) {\n            if (this.$data.mode === 'move') {\n                const transform = this.$data.canvas.viewportTransform;\n                transform[4] = transform[4] + (ev.offsetX - this.$data.startMouseX);\n                transform[5] = transform[5] + (ev.offsetY - this.$data.startMouseY);\n                this.$data.canvas.setViewportTransform(transform);\n                this.$data.startMouseX = ev.offsetX;\n                this.$data.startMouseY = ev.offsetY;\n            } else if (this.$data.mode === 'add') {\n                this.$data.newRect.set({\n                    width: (ev.offsetX - this.$data.startMouseX) / this.$data.zoom,\n                    height: (ev.offsetY - this.$data.startMouseY) / this.$data.zoom,\n                });\n                this.$data.canvas.renderAll();\n            }\n        }\n    }\n\n    /**\n     * Handles the mouse up event. If the mode is \"add\", then a the \"addJoke\" action is dispatched on the store\n     * with the bounding box of the new rectangle.\n     */\n    public mouseUp(ev: MouseEvent) {\n        this.$data.dragging = false;\n        if (this.$data.mode === 'add') {\n            this.$store.dispatch('addJoke', this.$data.newRect.getBoundingRect(true, true));\n            this.$data.canvas.remove(this.$data.newRect);\n            this.$data.newRect = null;\n            this.setMode('edit');\n        }\n    }\n\n    /**\n     * Handles the mouse scrolling and pans the canvas horizontally and vertically.\n     */\n    public mouseScroll(ev: WheelEvent) {\n        const transform = this.$data.canvas.viewportTransform;\n        transform[4] = transform[4] + ev.deltaX * 10;\n        transform[5] = transform[5] + ev.deltaY * 10;\n        this.$data.canvas.setViewportTransform(transform);\n    }\n\n    /**\n     * Handles selecting an object.\n     */\n    public objectSelected() {\n        this.$data.selected = this.$data.canvas.getActiveObject();\n    }\n\n    /**\n     * Handles deselecting an object, which means resetting its bounding box.\n     */\n    public objectDeselected() {\n        this.$data.selected.set({\n            left: this.$data.selected.sourceData.attributes.bbox.left,\n            top: this.$data.selected.sourceData.attributes.bbox.top,\n            width: this.$data.selected.sourceData.attributes.bbox.width,\n            height: this.$data.selected.sourceData.attributes.bbox.height,\n        });\n        this.$data.selected = null;\n        this.$data.canvas.renderAll();\n    }\n\n    /**\n     * Discards any changes to the current selection.\n     */\n    public discardChanges() {\n        this.$data.canvas.discardActiveObject().renderAll();\n    }\n\n    /**\n     * Saves changes to the current selection, updating the bounding box.\n     */\n    public saveChanges() {\n        if (!this.nothingSelected) {\n            this.$store.dispatch('updateJoke', {\n                jid: this.$data.selected.sourceData.id,\n                attrs: {\n                    bbox: this.$data.selected.getBoundingRect(true, true),\n                },\n            });\n            this.$data.canvas.discardActiveObject().renderAll();\n        }\n    }\n\n    // ************\n    // Dynamic data\n    // ************\n\n    /**\n     * Is the mode set to \"move\".\n     */\n    public get modeMove() {\n        return this.$data.mode === 'move' ? 'true' : 'false';\n    }\n\n    /**\n     * Is the mode not set to \"move\".\n     */\n    public get modeNotMove() {\n        return this.$data.mode !== 'move' ? 'true' : 'false';\n    }\n\n    /**\n     * Is the mode set to \"add\".\n     */\n    public get modeAdd() {\n        return this.$data.mode === 'add' ? 'true' : 'false';\n    }\n\n    /**\n     * Is the mode set to \"edit\".\n     */\n    public get modeEdit() {\n        return this.$data.mode === 'edit' ? 'true' : 'false';\n    }\n\n    /**\n     * Is the mode not set to \"edit\".\n     */\n    public get modeNotEdit() {\n        return this.$data.mode !== 'edit' ? 'true' : 'false';\n    }\n\n    /**\n     * Is anything selected.\n     */\n    public get nothingSelected() {\n        return this.$data.selected !== null ? null : 'disabled';\n    }\n\n    /**\n     * React to updates to the list of jokes, drawing their bounding boxes.\n     */\n    @Watch('$store.state.jokes')\n    public watchJokesList(newValue: object[], oldValue: object[]) {\n        this.$data.jokes.forEach((rect: fabric.Rect) => {\n            this.$data.canvas.remove(rect);\n        });\n        if (newValue) {\n            const jokes: fabric.Rect[] = [];\n            newValue.forEach((joke: fabric.Rect) => {\n                const rect = new fabric.Rect({\n                    left: joke.attributes.bbox.left,\n                    top: joke.attributes.bbox.top,\n                    width: joke.attributes.bbox.width,\n                    height: joke.attributes.bbox.height,\n                    fill: 'transparent',\n                    stroke: '#00aa00',\n                    hasRotatingPoint: false,\n                    hasBorders: false,\n                    transparentCorners: false,\n                    selectable: this.$data.mode === 'edit',\n                    cornerColor: '#000000',\n                    sourceData: joke,\n                });\n                jokes.push(rect);\n                this.$data.canvas.add(rect);\n            });\n            this.$data.jokes = jokes;\n        }\n    }\n\n    /**\n     * React to updates to the source URL, loading the image source data.\n     */\n    @Watch('$store.state.source.attributes.raw')\n    public watchSourceUrl(newValue: string, oldValue: string) {\n        if (newValue !== '') {\n            fabric.Image.fromURL(newValue, (img: fabric.Image) => {\n                this.$data.img = img;\n                this.$data.canvas.add(img);\n                img.set({\n                    selectable: false,\n                });\n                this.$data.canvas.sendToBack(img);\n                this.$data.imgBounds = this.$data.img.getBoundingRect();\n                this.$data.zoom = this.$data.viewerHeight / this.$data.imgBounds.height;\n                this.$data.maxZoom = this.$data.zoom;\n                this.update();\n            });\n        }\n    }\n\n    // ***************\n    // Private methods\n    // ***************\n\n    /**\n     * Update the canvas zoom.\n     */\n    private update() {\n        this.$data.canvas.setZoom(this.$data.zoom);\n    }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./JokeSelector.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./JokeSelector.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./JokeSelector.vue?vue&type=template&id=7dd45859&\"\nimport script from \"./JokeSelector.vue?vue&type=script&lang=ts&\"\nexport * from \"./JokeSelector.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"joke-list\"},[_c('nav',[_c('ul',{staticClass:\"menu\",attrs:{\"role\":\"menu\"}},[_c('li',{attrs:{\"role\":\"presentation\"}},[_c('a',{attrs:{\"data-action\":\"move\",\"role\":\"menuitem\",\"disabled\":_vm.nothingSelected},on:{\"click\":function($event){return _vm.deleteSelected()}}},[_c('svg',{staticClass:\"icon mdi\",attrs:{\"viewBox\":\"0 0 24 24\"}},[_c('path',{attrs:{\"d\":\"M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19M8,9H16V19H8V9M15.5,4L14.5,3H9.5L8.5,4H5V6H19V4H15.5Z\"}})])])])])]),_c('div',[(_vm.jokes.length > 0)?_c('ul',_vm._l((_vm.jokes),function(joke){return _c('li',[(joke === _vm.selectedJoke)?_c('a',{staticClass:\"selected\",on:{\"click\":function($event){return _vm.select(joke)}}},[_c('img',{attrs:{\"src\":joke.attributes.raw}})]):_c('a',{on:{\"click\":function($event){return _vm.select(joke)}}},[_c('img',{attrs:{\"src\":joke.attributes.raw}})])])}),0):_c('p',[_vm._v(\"Draw joke outlines on the left-hand side to extract jokes.\")])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue, Watch } from 'vue-property-decorator';\nimport { Joke } from '@/interfaces';\n\n@Component\nexport default class JokeList extends Vue {\n\n    // **************\n    // Event handlers\n    // **************\n\n    public select(joke: Joke) {\n        this.$store.commit('selectJoke', joke);\n    }\n\n    public deleteSelected() {\n        this.$store.dispatch('deleteJoke', this.$store.state.selected);\n    }\n\n    // ************\n    // Dynamic data\n    // ************\n\n    public get jokes() {\n        return this.$store.state.jokes;\n    }\n\n    public get selectedJoke() {\n        return this.$store.state.selected;\n    }\n\n    public get nothingSelected() {\n        return this.$store.state.selected === null ? 'disabled' : null;\n    }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./JokeList.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./JokeList.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./JokeList.vue?vue&type=template&id=2500243c&\"\nimport script from \"./JokeList.vue?vue&type=script&lang=ts&\"\nexport * from \"./JokeList.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"joke-transcriber\"},[_c('nav',[_c('ul',{staticClass:\"menu\",attrs:{\"role\":\"menu\"}},[_c('li',{attrs:{\"role\":\"presentation\"}},[_c('a',{attrs:{\"data-action\":\"confirm\",\"role\":\"menuitem\"},on:{\"click\":_vm.saveChanges}},[_c('svg',{staticClass:\"icon mdi\",attrs:{\"viewBox\":\"0 0 24 24\"}},[_c('path',{attrs:{\"d\":\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"}})])])]),_c('li',{attrs:{\"role\":\"presentation\"}},[_c('a',{attrs:{\"data-action\":\"cancel\",\"role\":\"menuitem\"},on:{\"click\":_vm.discardChanges}},[_c('svg',{staticClass:\"icon mdi\",attrs:{\"viewBox\":\"0 0 24 24\"}},[_c('path',{attrs:{\"d\":\"M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12C4,13.85 4.63,15.55 5.68,16.91L16.91,5.68C15.55,4.63 13.85,4 12,4M12,20A8,8 0 0,0 20,12C20,10.15 19.37,8.45 18.32,7.09L7.09,18.32C8.45,19.37 10.15,20 12,20Z\"}})])])]),_c('li',{attrs:{\"role\":\"separator\"}}),_c('li',{attrs:{\"role\":\"presentation\"}},[_c('a',{attrs:{\"role\":\"menuitem\",\"aria-checked\":_vm.mode === 'transcribe' ? 'true': 'false'},on:{\"click\":function($event){return _vm.setMode('transcribe')}}},[_c('svg',{staticClass:\"icon mdi\",attrs:{\"viewBox\":\"0 0 24 24\"}},[_c('path',{attrs:{\"d\":\"M8,12H16V14H8V12M10,20H6V4H13V9H18V12.1L20,10.1V8L14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H10V20M8,18H12.1L13,17.1V16H8V18M20.2,13C20.3,13 20.5,13.1 20.6,13.2L21.9,14.5C22.1,14.7 22.1,15.1 21.9,15.3L20.9,16.3L18.8,14.2L19.8,13.2C19.9,13.1 20,13 20.2,13M20.2,16.9L14.1,23H12V20.9L18.1,14.8L20.2,16.9Z\"}})])])]),_c('li',{attrs:{\"role\":\"presentation\"}},[_c('a',{attrs:{\"role\":\"menuitem\",\"aria-checked\":_vm.mode === 'attributes' ? 'true': 'false'},on:{\"click\":function($event){return _vm.setMode('attributes')}}},[_c('svg',{staticClass:\"icon mdi\",attrs:{\"viewBox\":\"0 0 24 24\"}},[_c('path',{attrs:{\"d\":\"M21.7,13.35L20.7,14.35L18.65,12.3L19.65,11.3C19.86,11.08 20.21,11.08 20.42,11.3L21.7,12.58C21.92,12.79 21.92,13.14 21.7,13.35M12,18.94L18.07,12.88L20.12,14.93L14.06,21H12V18.94M4,2H18A2,2 0 0,1 20,4V8.17L16.17,12H12V16.17L10.17,18H4A2,2 0 0,1 2,16V4A2,2 0 0,1 4,2M4,6V10H10V6H4M12,6V10H18V6H12M4,12V16H10V12H4Z\"}})])])])]),(_vm.mode === 'transcribe')?_c('editor-menu-bar',{attrs:{\"editor\":_vm.editor},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar commands = ref.commands;\nvar isActive = ref.isActive;\nreturn [_c('ul',{staticClass:\"menu\",staticStyle:{\"flex-wrap\":\"wrap\"},attrs:{\"role\":\"menu\"}},[_c('li',{attrs:{\"role\":\"presentation\"}},[_c('a',{attrs:{\"role\":\"menuitem\",\"aria-checked\":isActive.annotation() ? 'true' : 'false'},on:{\"click\":commands.annotation}},[_vm._v(\"Annotation\")])])])]}}],null,false,2445674567)}):_vm._e()],1),(_vm.mode === 'transcribe')?_c('div',[_c('editor-content',{attrs:{\"editor\":_vm.editor}}),_c('editor-menu-bar',{attrs:{\"editor\":_vm.editor},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar commands = ref.commands;\nvar isActive = ref.isActive;\nreturn [(isActive.annotation())?_c('div',[_c('label',[_vm._v(\"Annotation Type \"),_c('select',{on:{\"change\":function($event){return _vm.setAnnotationAttributeValue('category', $event.target.value)}}},[_c('option',{attrs:{\"value\":\"\"}},[_vm._v(\"--- Please Select ---\")]),_vm._l((_vm.annotations),function(annotation){return [(annotation.separate)?_c('option',{staticStyle:{\"font-size\":\"1pt\",\"background-color\":\"#000000\"},attrs:{\"disabled\":\"disabled\"}}):_vm._e(),_c('option',{domProps:{\"value\":annotation.name,\"selected\":_vm.hasAnnotationAttributeValue('category', annotation.name) ? 'selected' : null,\"innerHTML\":_vm._s(annotation.label)}})]})],2)]),_vm._l((_vm.annotations),function(annotation){return [_vm._l((annotation.attrs),function(attr){return (_vm.hasAnnotationAttributeValue('category', annotation.name))?[_c('label',[_vm._v(_vm._s(attr.label)+\" \"),(attr.type === 'select')?_c('select',{on:{\"change\":function($event){return _vm.setAnnotationAttributeValue('settings', {name: attr.name, value: $event.target.value})}}},_vm._l((attr.values),function(value){return _c('option',{domProps:{\"value\":value[0],\"selected\":_vm.getAnnotationAttributeValue('settings')[attr.name] === value[0] ? 'selected' : null,\"innerHTML\":_vm._s(value[1])}})}),0):_vm._e()])]:_vm._e()})]})],2):_vm._e()]}}],null,false,3116511434)})],1):(_vm.mode === 'attributes')?_c('div',_vm._l((_vm.metadata),function(entry){return _c('div',{staticClass:\"margin-bottom\"},[_c('h2',{staticClass:\"font-size-default\"},[_vm._v(_vm._s(entry.label))]),(entry.type === 'multichoice')?_c('div',_vm._l((entry.values),function(value){return _c('label',[_c('input',{attrs:{\"type\":\"checkbox\"},domProps:{\"value\":value[0],\"checked\":_vm.hasAttributeValue(entry.name, value[0], true) ? 'checked' : null},on:{\"change\":function($event){$event.target.checked ? _vm.addAttributeValue(entry.name, value[0]) : _vm.removeAttributeValue(entry.name, value[0])}}}),_vm._v(\" \"),_c('span',{domProps:{\"innerHTML\":_vm._s(value[1])}})])}),0):(entry.type === 'select')?_c('select',{on:{\"change\":function($event){return _vm.setAttributeValue(entry.name, $event.target.value)}}},_vm._l((entry.values),function(value){return _c('option',{domProps:{\"value\":value[0],\"selected\":_vm.hasAttributeValue(entry.name, value[0]) ? 'selected' : null,\"innerHTML\":_vm._s(value[1])}})}),0):_vm._e(),(entry.type === 'multitext')?_c('div',[_c('ol',{staticClass:\"no-bullet\"},_vm._l((_vm.getAttributeValue(entry.name)),function(value){return _c('li',{staticClass:\"value-and-action\"},[_c('span',[_vm._v(_vm._s(value))]),_c('a',{attrs:{\"aria-label\":\"Delete\"},on:{\"click\":function($event){return _vm.removeAttributeValue(entry.name, value)}}},[_c('svg',{staticClass:\"icon mdi\",attrs:{\"viewBox\":\"0 0 24 24\"}},[_c('path',{attrs:{\"d\":\"M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19M8,9H16V19H8V9M15.5,4L14.5,3H9.5L8.5,4H5V6H19V4H15.5Z\"}})])])])}),0),_c('div',{staticClass:\"autosuggest\"},[_c('input',{attrs:{\"type\":\"text\"},on:{\"keyup\":function($event){return _vm.keyUp(entry, $event)}}}),(_vm.autosuggests[entry.name] && _vm.autosuggests[entry.name].length > 0)?_c('ul',{staticClass:\"no-bullet\"},_vm._l((_vm.autosuggests[entry.name]),function(suggest){return _c('li',[_c('a',{on:{\"click\":function($event){return _vm.addAttributeValue(entry.name, suggest)}}},[_vm._v(_vm._s(suggest))])])}),0):_vm._e()])]):_vm._e()])}),0):_vm._e(),(_vm.noTranscription)?_c('div',{staticClass:\"overlay\"},[_c('p',[_vm._v(\"Please select a joke from the list to transcribe and annotate it.\")])]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","// @ts-ignore\nimport { Mark } from 'tiptap';\n// @ts-ignore\nimport { toggleMark } from 'tiptap-commands';\n\nexport default class AnnotationMark extends Mark {\n\n    public get name() {\n        return 'annotation';\n    }\n\n    public get schema() {\n        return {\n            attrs: {\n                category: {\n                    default: '',\n                },\n                settings: {\n                    default: {},\n                },\n            },\n            parseDOM: [\n                {\n                    tag: 'span.mark-annotation',\n                },\n            ],\n            toDOM: () => ['span', { class: 'mark-annotation' }, 0],\n        };\n    }\n\n    public commands({ type }: any) {\n        return () => toggleMark(type);\n    }\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Watch } from 'vue-property-decorator';\n// @ts-ignore\nimport { Editor, EditorContent, EditorMenuBar } from 'tiptap';\n// @ts-ignore\nimport { removeMark, updateMark } from 'tiptap-commands';\nimport AnnotationMark from '@/markup/AnnotationMark';\n// @ts-ignore\nimport deepcopy from 'deepcopy';\nimport axios from 'axios';\n\nimport { Joke, Transcription } from '@/interfaces';\n\n@Component({\n    components: {\n        EditorContent,\n        EditorMenuBar,\n    },\n})\nexport default class JokeTranscriber extends Vue {\n    public mode = 'transcribe';\n    public editor: Editor | null = null;\n    public attributes: any = {};\n    public autosuggests: any = {};\n\n    // ****************\n    // Lifecycle events\n    // ****************\n\n    public mounted() {\n        this.editor = new Editor({\n            extensions: [\n                new AnnotationMark(),\n            ],\n        });\n    }\n\n    public beforeDestroy() {\n        if (this.editor) {\n            this.editor.destroy();\n        }\n    }\n\n    // **************\n    // Event handlers\n    // **************\n\n    public saveChanges() {\n        this.attributes = { ... this.attributes, ... { text: this.editor.getJSON() }};\n        this.$store.dispatch('updateTranscription', this.attributes);\n    }\n\n    public discardChanges() {\n        this.editor.setContent(this.$store.state.transcription.attributes.text);\n    }\n\n    public setMode(mode: string) {\n        this.mode = mode;\n    }\n\n    public getAttributeValue(name: string) {\n        return this.attributes[name];\n    }\n\n    public addAttributeValue(name: string, value: string) {\n        let values = this.attributes[name];\n        if (!values) {\n            values = [];\n        }\n        if (values.indexOf(value) < 0 && value) {\n            values.push(value);\n        }\n        this.attributes = { ... this.attributes, ... { [name]: values} };\n        if (this.autosuggests[name]) {\n            this.autosuggests = {};\n        }\n    }\n\n    public removeAttributeValue(name: string, value: string) {\n        const values = this.attributes[name];\n        if (values) {\n            if (values.indexOf(value) >= 0) {\n                values.splice(values.indexOf(value), 1);\n            }\n            this.attributes = { ... this.attributes, ... { [name]: values} };\n        } else {\n            this.attributes = { ... this.attributes, ... { [name]: []} };\n        }\n    }\n\n    public setAttributeValue(name: string, value: string) {\n        this.attributes = { ... this.attributes, ... { [name]: value} };\n    }\n\n    public keyUp(entry: any, event: KeyboardEvent) {\n        if (event !== null && event !== undefined) {\n            if (entry.type === 'multitext') {\n                if (event.keyCode === 13) {\n                    this.addAttributeValue(entry.name, (event.target as HTMLInputElement).value);\n                    (event.target as HTMLInputElement).value = '';\n                } else {\n                    axios.get(entry.autosuggest, {\n                        params: {\n                            value: (event.target as HTMLInputElement).value,\n                        },\n                    }).then((response) => {\n                        this.autosuggests = {[entry.name]: response.data};\n                    });\n                }\n            }\n        }\n    }\n\n    // ************\n    // Dynamic data\n    // ************\n\n    public get annotations() {\n        return this.$store.state.annotations;\n    }\n\n    public get metadata() {\n        return this.$store.state.metadata;\n    }\n\n    public get noTranscription() {\n        return this.$store.state.transcription === null;\n    }\n\n    /**\n     * Computed property of all selected nodes.\n     */\n    private get selectedNodes() {\n        if (this.editor) {\n            const { from, to } = this.editor.state.selection;\n            const selectedNodes = [] as any;\n            this.editor.state.doc.nodesBetween(from, to, (node: any) => {\n                selectedNodes.push(node);\n            });\n            return selectedNodes;\n        } else {\n            return [];\n        }\n    }\n\n    // ************\n    // Data watches\n    // ************\n\n    @Watch('$store.state.selected')\n    public watchSelectedJoke(newValue: Joke, oldValue: Joke) {\n        this.$store.dispatch('loadTranscription');\n    }\n\n    @Watch('$store.state.transcription')\n    public watchTranscription(newValue: Transcription) {\n        if (newValue) {\n            this.editor.setContent(newValue.attributes.text);\n            this.attributes = deepcopy(newValue.attributes);\n        } else {\n            this.editor.setContent('');\n            this.attributes = {};\n        }\n    }\n\n    // *******************\n    // Annotation handling\n    // *******************\n\n    /**\n     * Gets a mark attribute value.\n     */\n    public getAnnotationAttributeValue(attrName: string) {\n        for (const node of this.selectedNodes) {\n            if (node.marks) {\n                for (const mark of node.marks) {\n                    if (mark.type.name === 'annotation') {\n                        return mark.attrs[attrName];\n                    }\n                }\n            }\n        }\n        return '';\n    }\n\n    /**\n     * Checks whether a mark has a given attribute value.\n     */\n    public hasAnnotationAttributeValue(attrName: string, value: string) {\n        return this.getAnnotationAttributeValue(attrName) === value;\n    }\n\n    /**\n     * Sets the mark's attribute value.\n     */\n    public setAnnotationAttributeValue(attrName: string, value: any) {\n        if (value) {\n            const { from, to } = this.editor.state.selection;\n            let attributes = {} as any;\n            this.editor.state.doc.nodesBetween(from, to, (node: any) => {\n                if (node.marks) {\n                    node.marks.forEach((mark: any) => {\n                        if (mark.type.name === 'annotation') {\n                            attributes = {...attributes, ...mark.attrs};\n                        }\n                    });\n                }\n            });\n            if (attrName === 'settings') {\n                if (!attributes.settings) {\n                    attributes.settings = {};\n                }\n                attributes.settings[value.name] = value.value;\n            } else if (attrName === 'category') {\n                attributes[attrName] = value;\n            }\n            updateMark(this.editor.schema.marks.annotation, attributes)(this.editor.state,\n                this.editor.dispatchTransaction.bind(this.editor));\n        } else {\n            removeMark(this.editor.schema.marks.annotation)(this.editor.state,\n                this.editor.dispatchTransaction.bind(this.editor));\n        }\n    }\n\n    // *******************\n    // Annotation handling\n    // *******************\n\n    public hasAttributeValue(name: string, value: string, multiple?: boolean) {\n        const values = this.attributes[name];\n        if (multiple) {\n            if (values) {\n                return values.indexOf(value) >= 0;\n            } else {\n                return false;\n            }\n        } else {\n            return values === value;\n        }\n    }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./JokeTranscriber.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./JokeTranscriber.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./JokeTranscriber.vue?vue&type=template&id=1ea56b22&\"\nimport script from \"./JokeTranscriber.vue?vue&type=script&lang=ts&\"\nexport * from \"./JokeTranscriber.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\nimport { Component, Vue } from 'vue-property-decorator';\nimport JokeSelector from '@/components/JokeSelector.vue';\nimport JokeList from '@/components/JokeList.vue';\nimport JokeTranscriber from '@/components/JokeTranscriber.vue';\n\n@Component({\n    components: {\n        JokeSelector,\n        JokeList,\n        JokeTranscriber,\n    },\n})\nexport default class App extends Vue {\n    public mounted() {\n        this.$store.dispatch('loadSource');\n        this.$store.dispatch('loadJokes');\n    }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=3575c809&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import axios from 'axios';\nimport Vue from 'vue';\nimport Vuex from 'vuex';\n\nimport { State, Config, Joke, Transcription } from '@/interfaces';\n\nVue.use(Vuex);\n\nfunction makeInitialState(config: Config): State {\n    return {\n        baseURL: config.baseURL,\n        sourceId: config.sourceId,\n        userId: config.userId,\n        annotations: config.annotations,\n        metadata: config.metadata,\n        source: {},\n        jokes: [],\n        selected: null,\n        transcription: null,\n    };\n}\n\nexport default function makeStore(config: Config) {\n    return new Vuex.Store({\n        state: makeInitialState(config),\n        mutations: {\n            updateSource(state, source) {\n                state.source = source;\n            },\n            updateJokesList(state, jokes: Joke[]) {\n                state.jokes = jokes;\n            },\n            selectJoke(state, joke: Joke) {\n                if (state.selected === joke || joke === null) {\n                    state.selected = null;\n                    state.transcription = null;\n                } else {\n                    state.selected = joke;\n                }\n            },\n            setTranscription(state, transcription: Transcription) {\n                state.transcription = transcription;\n            },\n        },\n        actions: {\n            loadSource(store) {\n                axios.get(store.state.baseURL + '/sources/' + store.state.sourceId).then((response) => {\n                    store.commit('updateSource', response.data.data);\n                    store.dispatch('loadJokes');\n                });\n            },\n            loadJokes(store) {\n                axios.get(store.state.baseURL + '/jokes', {\n                    params: {\n                        'filter[owner_id]': store.state.userId,\n                        'filter[parent_id]': store.state.sourceId,\n                    },\n                }).then((response) => {\n                    store.commit('updateJokesList', response.data.data);\n                });\n            },\n            loadTranscription(store) {\n                if (store.state.selected) {\n                    const selectedId = store.state.selected.id;\n                    axios.get(store.state.baseURL + '/transcriptions', {\n                        params: {\n                            'filter[owner_id]': store.state.userId,\n                            'filter[source_id]': selectedId,\n                        },\n                    }).then((response) => {\n                        if (response.data.data.length === 0) {\n                            // If there is no existing transcription by the user, fetch the generic OCR transcription\n                            axios.get(store.state.baseURL + '/transcriptions', {\n                                params: {\n                                    'filter[source_id]': selectedId,\n                                    'filter[status]': 'ocr',\n                                },\n                            }).then((response2) => {\n                                // If there is no OCR transcription, set an empty text, otherwise set the OCR text\n                                if (response2.data.data.length === 0) {\n                                    store.commit('setTranscription', {\n                                        type: 'transcriptions',\n                                        attributes: {\n                                            source_id: selectedId,\n                                            text: '',\n                                            status: 'new',\n                                        },\n                                    });\n                                } else {\n                                    store.commit('setTranscription', {\n                                        type: 'transcriptions',\n                                        attributes: {\n                                            source_id: selectedId,\n                                            text: response2.data.data[0].attributes.text,\n                                            status: 'new',\n                                        },\n                                    });\n                                }\n                            });\n                        } else {\n                            store.commit('setTranscription', response.data.data[0]);\n                        }\n                    });\n                }\n            },\n            addJoke(store, bbox) {\n                axios.post(store.state.baseURL + '/jokes', {\n                    data: {\n                        type: 'jokes',\n                        attributes: {\n                            parent_id: store.state.sourceId,\n                            bbox,\n                        },\n                    },\n                }).then((response) => {\n                    const jokes = store.state.jokes.slice();\n                    jokes.push(response.data.data);\n                    store.commit('updateJokesList', jokes);\n                });\n            },\n            updateJoke(store, { jid, attrs }) {\n                store.state.jokes.forEach((joke: Joke) => {\n                    if (joke.id === jid) {\n                        joke = { ...joke };\n                        joke.attributes = { ...joke.attributes, ...attrs };\n                        axios.put(store.state.baseURL + '/jokes/' + joke.id, {\n                            data: joke,\n                        }).then((response) => {\n                            const newJokes: Joke[] = [];\n                            store.state.jokes.forEach((joke2: Joke) => {\n                                if (joke2.id === jid) {\n                                    newJokes.push(response.data.data);\n                                } else {\n                                    newJokes.push(joke2);\n                                }\n                            });\n                            store.commit('updateJokesList', newJokes);\n                        });\n                    }\n                });\n            },\n            deleteJoke(store, joke: Joke) {\n                axios.delete(store.state.baseURL + '/jokes/' + joke.id).\n                      then((response) => {\n                          store.commit('selectJoke', null);\n                          store.dispatch('loadJokes');\n                      });\n            },\n            updateTranscription(store, attrs: object) {\n                const transcription = { ...store.state.transcription } as Transcription;\n                transcription.attributes = { ...transcription.attributes, ...attrs };\n                if (transcription.id) {\n                    axios.patch(store.state.baseURL + '/transcriptions/' + transcription.id, {\n                        data: transcription,\n                    }).then((response) => {\n                        store.commit('setTranscription', response.data.data);\n                    });\n                } else {\n                    axios.post(store.state.baseURL + '/transcriptions', {\n                        data: transcription,\n                    }).then((response) => {\n                        store.commit('setTranscription', response.data.data);\n                    });\n                }\n            },\n        },\n    });\n}\n","import Vue from 'vue';\nimport App from './App.vue';\nimport makeStore from './store';\nimport { Config } from '@/interfaces';\n\nVue.config.productionTip = false;\n\nconst configElement = document.getElementById('config');\nlet config: Config = {\n    baseURL: '',\n    sourceId: null,\n    userId: null,\n    annotations: [],\n    metadata: [],\n};\nif (configElement) {\n    config = JSON.parse(configElement.innerHTML);\n}\nconst store = makeStore(config);\n\nnew Vue({\n    store,\n    render: (h) => h(App),\n}).$mount('#app');\n"],"sourceRoot":""}